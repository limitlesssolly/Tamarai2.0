<!DOCTYPE html>
<html lang="en">

<head>
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
    <link rel="stylesheet" href="/css/user/usernav.css">
    <link rel="shortcut icon" type="image/jpg" href="/images/thebluelogo.png" />

</head>

<body>

    <div class="nav">

        <img src="/images/theblackicon.png" class="brand-logo" alt="Tamarii Logo">

        <span class="title">
            <h1>Tamarai</h1>
        </span>

        <div class="nav_items">

            <div class="box">
                <input type="text" placeholder="Search" id="searches" onkeyup="sendData(this)">
                <section id="srchResults"></section>
            </div>

            <a href="/user/homepage/profile"><img src="/images/uses.png" alt="user"></a>
            <a href="/user/homepage/bag/checkout"><img src="/images/carter.png" alt="cart"> (
                <% if (typeof cart !== 'undefined') { %>
                    <%= cart.length %>
                        <% } else { %>
                            0
                            <% } %>

                                )</a>
            <a href="/user/homepage/whishlist"><img src="/images/wishes.png" alt="Wishlist"></a>
            <a href="/user/logout"><img src="/images/lo.png" alt="logout"></a>
        </div>

    </div>
    <ul>
        <li>

        </li>
    </ul>
    <div class="container">
        <%- messages('messages', locals) %>
    </div>

</body>

<script>
    function sendData(e) {
        const searchResults = document.getElementById('searchResults');
        fetch('getProducts', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                payload: e.value
            })
        }).then(res => res.json()).then(data => {
            let payload = data.payload;
            // console.log(payload);
            searchResults.innerHTML = '';
            if (payload.length < 1) {
                searchResults.innerHTML = '<p>Sorry. Nothing Found.</p>';
                return;
            }
            payload.forEach((item, index) => {
                if (index > 0) {
                    searchResults.innerHTML += '<hr>';
                }
                searchResults.innerHTML += `<p>${item.name}</p>`;
            });
        });
    }
</script>

</html>